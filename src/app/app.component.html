<div class="container">
  <h1>Gestion des Tests TOEIC</h1>

  <!-- Formulaire pour ajouter ou modifier un test -->
  <form (ngSubmit)="onSubmit()">
    <div>
      <label>ID :</label>
      <input [(ngModel)]="test.ID_date_groupe" name="id" type="number" readonly />
    </div>
    <div>
      <label>Titre :</label>
      <input [(ngModel)]="test.Titre" name="titre" type="text" required />
    </div>
    <div>
      <label>Type :</label>
      <select [(ngModel)]="test.Type" name="type" required>
        <option value="">Sélectionnez...</option>
        <option value="Écrit">Écrit</option>
        <option value="Oral">Oral</option>
      </select>
    </div>
    <div>
      <label>Date :</label>
      <input [(ngModel)]="test.Date" name="date" type="date" required />
    </div>
    <button type="submit">Enregistrer</button>
  </form>

  <!-- Liste des tests -->
  <h2>Liste des Tests</h2>
  <table *ngIf="tests.length > 0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Titre</th>
        <th>Type</th>
        <th>Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let t of tests">
        <td>{{ t.ID_date_groupe }}</td>
        <td>{{ t.Titre }}</td>
        <td>{{ t.Type }}</td>
        <td>{{ t.Date }}</td>
        <td>
          <button (click)="editTest(t)">Modifier</button>
          <button (click)="deleteTest(t.ID_date_groupe!)">Supprimer</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Téléchargement et traitement de fichiers PDF -->
  <h2>Importation des fichiers PDF</h2>
  <input type="file" (change)="onFileSelected($event)" accept=".pdf" />
  <button (click)="uploadPDF()">Télécharger et traiter</button>

  <!-- Résultats du traitement -->
  <div *ngIf="uploadResponse">
    <h3>Résultats :</h3>
    <pre>{{ uploadResponse | json }}</pre>
  </div>




  <h2>Créer un nouveau test</h2>
  <form (ngSubmit)="onSubmit()">
    <div>
      <label>Titre :</label>
      <input [(ngModel)]="test.Titre" name="titre" type="text" required placeholder="Entrez le titre du test" />
    </div>
    <div>
      <label>Description :</label>
      <textarea [(ngModel)]="test.Description" name="description" placeholder="Entrez une description (optionnel)"></textarea>
    </div>
    <div>
      <label>Type de test :</label>
      <select [(ngModel)]="test.Type" name="type" required>
        <option value="">Sélectionnez...</option>
        <option value="Écrit">Écrit</option>
        <option value="Oral">Oral</option>
      </select>
    </div>
    <div>
      <label>Date :</label>
      <input [(ngModel)]="test.Date" name="date" type="date" required />
    </div>
    <div>
      <label>Groupe assigné :</label>
      <select [(ngModel)]="test.groupe" name="groupe" required>
        <option value="Cls 1 24-25 PODVIN">Cls 1 24-25 PODVIN</option>
        <option value="Cls 2 24-25 PODVIN">Cls 2 24-25 PODVIN</option>
      </select>
    </div>
    <button type="submit">Suivant</button>
  </form>



  <div class="container">
    <h2>Saisie des réponses pour le test : {{ test.Titre }}</h2>
    <button (click)="generateQuestions()">Générer 200 questions</button>
    <form (ngSubmit)="saveResponses()">
      <table>
        <thead>
          <tr>
            <th>Question</th>
            <th>Réponse correcte</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let question of questions">
            <td>{{ question.numero }}</td>
            <td>
              <select [(ngModel)]="question.reponse" name="reponse{{ question.numero }}" required>
                <option value="">Sélectionnez...</option>
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>
      <button type="submit">Enregistrer les réponses</button>
    </form>
  </div>
  
</div>




